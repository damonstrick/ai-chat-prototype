<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>AI Chat Demo – Presentation</title>
  <style>
    @font-face {
      font-family: 'GT Standard';
      src: url('fonts/GT-Standard-M-Standard-Light.woff2') format('woff2'),
           url('fonts/GT-Standard-M-Standard-Light.woff') format('woff');
      font-weight: 300;
      font-style: normal;
      font-display: swap;
    }
    @font-face {
      font-family: 'GT Standard';
      src: url('fonts/GT-Standard-M-Standard-Regular.woff2') format('woff2'),
           url('fonts/GT-Standard-M-Standard-Regular.woff') format('woff');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }
    @font-face {
      font-family: 'GT Standard';
      src: url('fonts/GT-Standard-M-Standard-Medium.woff2') format('woff2'),
           url('fonts/GT-Standard-M-Standard-Medium.woff') format('woff');
      font-weight: 500;
      font-style: normal;
      font-display: swap;
    }
    @font-face {
      font-family: 'GT Standard';
      src: url('fonts/GT-Standard-M-Standard-Semibold.woff2') format('woff2'),
           url('fonts/GT-Standard-M-Standard-Semibold.woff') format('woff');
      font-weight: 600;
      font-style: normal;
      font-display: swap;
    }
    @font-face {
      font-family: 'GT Standard';
      src: url('fonts/GT-Standard-M-Standard-Bold.woff2') format('woff2'),
           url('fonts/GT-Standard-M-Standard-Bold.woff') format('woff');
      font-weight: 700;
      font-style: normal;
      font-display: swap;
    }
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      font-family: 'GT Standard', -apple-system, BlinkMacSystemFont, sans-serif;
      color: #0d0d0d;
      overflow: hidden;
    }

    /* Video as slide background (behind the mockup) */
    .slide-backdrop {
      position: fixed;
      inset: 0;
      z-index: 0;
      background: #1a1a1e;
    }
    .slide-backdrop video {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .slide-backdrop::after {
      content: '';
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.2);
      pointer-events: none;
    }
    /* Concept 2: solid background, no video */
    .slide-backdrop.concept-2 {
      background: #F8F7F1;
    }
    .slide-backdrop.concept-2 video {
      visibility: hidden;
      pointer-events: none;
    }
    .slide-backdrop.concept-2::after {
      display: none;
    }
    .slide-backdrop.concept-2 .bg-video-prompt {
      display: none;
    }
    .bg-video-prompt {
      position: absolute;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 20px;
      background: rgba(0,0,0,0.6);
      color: #fff;
      font-size: 14px;
      border-radius: 8px;
      z-index: 2;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .bg-video-prompt.visible {
      opacity: 1;
    }

    /* Content on top of slide: centered phone mockup */
    .slide-content {
      position: relative;
      z-index: 1;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 24px;
    }

    /* Wrapper for zoom-in-on-top effect after full-screen transition */
    .phone-frame-zoom-wrapper {
      width: 100%;
      max-width: 430px;
      transform-origin: center top;
      transition: transform 1.2s ease-in-out;
    }
    .phone-frame-zoom-wrapper.zoom-in-top {
      transform: scale(1.22);
    }
    .phone-frame-zoom-wrapper.zoom-drawer-open {
      transform: scale(1.08);
    }
    .phone-frame-zoom-wrapper.zoom-final {
      transform: scale(1.06);
    }

    /* Phone frame: 956px tall (iPhone-like), scrollable inner area */
    .phone-frame {
      position: relative;
      width: 100%;
      max-width: 430px;
      height: 956px;
      border-radius: 44px;
      overflow: hidden;
      box-shadow: 0px 4.63px 15.43px 0px rgba(0, 0, 0, 0.07), 0px 0px 0px 2.31px rgba(28, 28, 30, 0.19);
      background: #EFF1F5;
      display: flex;
      flex-direction: column;
      transition: height 0.5s ease, border-radius 0.5s ease, box-shadow 0.5s ease, border 0.5s ease;
    }

    /* Initial state: only the input capsule visible (no frame, no background) */
    .phone-frame.initial {
      height: auto;
      min-height: 76px;
      overflow: visible;
      border-radius: 0;
      box-shadow: none;
      background: transparent;
      border: none;
    }
    .phone-frame.initial .top-bar,
    .phone-frame.initial .chat-container {
      max-height: 0;
      min-height: 0;
      opacity: 0;
      overflow: hidden;
      flex-shrink: 0;
      transition: max-height 0.45s ease, opacity 0.4s ease 0.1s;
    }
    .phone-frame .top-bar {
      max-height: 100px;
      transition: max-height 0.45s ease, opacity 0.4s ease 0.1s;
    }
    .phone-frame .chat-container {
      max-height: 800px;
      transition: max-height 0.45s ease, opacity 0.4s ease 0.1s;
    }
    .phone-frame.initial .input-area {
      flex-shrink: 0;
      background: transparent;
      padding: 0;
    }

    .top-bar {
      background: rgba(239, 241, 245, 0.35);
      opacity: 1;
      flex-shrink: 0;
      border-bottom: 1px solid #e3e7ea;
    }

    .header {
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding: 32px 16px 0;
      gap: 0;
      margin-top: 0;
    }
    .header-left, .header-right {
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .header-left {
      width: 100%;
      justify-content: flex-start;
    }
    .header-right {
      width: 100%;
      justify-content: flex-end;
    }
    .header-center {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      font-family: 'GT Standard', -apple-system, BlinkMacSystemFont, sans-serif;
      font-size: 17px;
      font-weight: 510;
      line-height: 22px;
      letter-spacing: -0.43px;
      color: #141413;
    }
    .header-center .sparkle-icon {
      width: 20px;
      height: 20px;
      color: #0d0d0d;
      flex-shrink: 0;
    }
    .header .header-icon-img {
      width: 24px;
      height: 24px;
      object-fit: contain;
      display: block;
    }
    .header-center .header-icon-img {
      width: 20px;
      height: 20px;
    }
    .header .nav-icon {
      width: 24px;
      height: 24px;
      color: #0d0d0d;
      border: none;
      background: none;
      padding: 0;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .header .nav-icon img {
      width: 24px;
      height: 24px;
      object-fit: contain;
    }
    .header .nav-icon svg {
      width: 24px;
      height: 24px;
    }

    /* Chat area: fills remaining height in phone, scrolls when content overflows */
    .phone-frame .chat-container {
      flex: 1;
      min-height: 0;
      min-width: 0;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 16px;
      scroll-behavior: smooth;
      background: #EFF1F5;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    .phone-frame .chat-container::-webkit-scrollbar {
      display: none;
    }

    .message {
      margin-bottom: 16px;
      min-width: 0;
      animation: messageIn 0.3s ease-out;
    }
    @keyframes messageIn {
      from { opacity: 0; transform: translateY(6px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* User bubble: right-aligned, light gray */
    .message.user {
      display: flex;
      justify-content: flex-end;
    }
    .bubble.user {
      max-width: 85%;
      padding: 12px 16px;
      border-radius: 18px 18px 4px 18px;
      font-size: 17px;
      line-height: 23px;
      letter-spacing: -0.43px;
      background: #e3e7ea;
      color: #0d0d0d;
    }

    /* AI message: left-aligned */
    .message.assistant {
      display: flex;
      justify-content: flex-start;
    }
    .bubble.assistant {
      max-width: 100%;
      min-width: 0;
      padding: 0;
      margin-top: 0;
      margin-bottom: 0;
      font-size: 17px;
      font-weight: 300;
      line-height: 23px;
      letter-spacing: -0.43px;
      color: #141413;
      background: transparent;
    }
    .bubble.assistant .text-block {
      margin-bottom: 12px;
    }
    .bubble.assistant .text-block p { margin: 0 0 8px; }
    .bubble.assistant .text-block strong { font-weight: 600; }
    .bubble.assistant ul {
      margin: 8px 0 12px;
      padding-left: 20px;
    }
    .bubble.assistant li { margin-bottom: 4px; }

    /* Loading text – muted like dots, with shimmer */
    .loading-text {
      display: inline-flex;
      align-items: baseline;
      flex-wrap: wrap;
      gap: 0;
      padding: 12px 0;
      font-size: 17px;
      line-height: 23px;
      letter-spacing: -0.43px;
      color: #8f8f8f;
      background: linear-gradient(
        90deg,
        #8f8f8f 0%,
        #8f8f8f 30%,
        #c4c4c4 50%,
        #8f8f8f 70%,
        #8f8f8f 100%
      );
      background-size: 200% 100%;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: shimmer 1.8s ease-in-out infinite;
    }
    .loading-text .loading-ellipsis span {
      display: inline-block;
      animation: bounce 0.6s ease-in-out infinite;
    }
    .loading-text .loading-ellipsis span:nth-child(1) { animation-delay: 0s; }
    .loading-text .loading-ellipsis span:nth-child(2) { animation-delay: 0.15s; }
    .loading-text .loading-ellipsis span:nth-child(3) { animation-delay: 0.3s; }
    @keyframes shimmer {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    @keyframes bounce {
      0%, 60%, 100% { transform: translateY(0); opacity: 0.5; }
      30% { transform: translateY(-2px); opacity: 1; }
    }

    /* Provider card – Figma 487-37654 */
    .provider-card {
      background: #fff;
      border: 1px solid #e3e7ea;
      border-radius: 16px;
      padding: 16px;
      margin: 16px 0;
      box-shadow: 0 1px 3px rgba(0,0,0,0.06);
    }
    .provider-card-section {
      padding: 0;
    }
    .provider-card-divider {
      height: 1px;
      background: #e3e7ea;
      border: none;
      margin: 14px 0;
    }
    .provider-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 4px;
    }
    .provider-card-title {
      font-size: 15px;
      font-weight: 600;
      color: #0d0d0d;
      flex: 1;
      min-width: 0;
    }
    .provider-card-rating {
      font-size: 13px;
      font-weight: 500;
      color: #0d0d0d;
      white-space: nowrap;
      vertical-align: bottom;
      display: flex;
      flex-flow: row;
      justify-content: flex-start;
      align-items: flex-start;
      gap: 4px;
    }
    .provider-card-rating .star {
      color: #0d0d0d;
      display: inline;
      vertical-align: middle;
    }
    .provider-card-category {
      font-size: 13px;
      color: #8f8f8f;
      margin-bottom: 12px;
    }
    .provider-card-meta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    .provider-card-pill {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 0 12px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 500;
      color: #0d0d0d;
      background: #f2f2f2;
      border: 1px solid #e3e7ea;
    }
    .provider-card-pill svg {
      width: 14px;
      height: 14px;
      flex-shrink: 0;
    }
    .provider-cost-block {
      text-align: right;
    }
    .provider-cost-label {
      display: block;
      font-size: 12px;
      font-weight: 400;
      color: #8f8f8f;
      margin-bottom: 2px;
    }
    .provider-cost-value {
      font-size: 17px;
      font-weight: 600;
      color: #0d0d0d;
    }
    .provider-doctor {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .provider-doctor-avatar {
      width: 48px;
      height: 48px;
      min-width: 48px;
      border-radius: 50%;
      background: #e3e7ea center / cover no-repeat;
      border: 1px solid #e3e7ea;
    }
    .provider-doctor-name {
      font-size: 15px;
      font-weight: 600;
      color: #0d0d0d;
    }
    .provider-doctor-spec {
      font-size: 13px;
      color: #8f8f8f;
      margin-top: 2px;
    }
    .provider-card .btn-primary {
      display: block;
      width: 100%;
      padding: 14px 16px;
      border-radius: 12px;
      border: none;
      background: #3a3a3c;
      color: #fff;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 2px;
      transition: transform 0.12s ease;
    }
    .provider-card .btn-primary.demo-tap {
      transform: scale(0.96);
    }
    .provider-disclaimer {
      font-size: 11px;
      color: #8f8f8f;
      margin-top: 10px;
      line-height: 1.35;
      text-align: center;
    }

    /* Turquoise / Sources */
    .sources-block {
      margin-top: 16px;
      padding-top: 12px;
      border-top: 1px solid #e3e7ea;
    }
    .sources-link {
      font-size: 15px;
      font-weight: 510;
      color: #0d0d0d;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-bottom: 6px;
    }
    .sources-desc {
      font-size: 13px;
      color: #8f8f8f;
      margin-bottom: 12px;
    }
    .sources-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }
    .sources-pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px 6px 14px;
      border-radius: 10px;
      background: unset;
      background-color: rgba(239, 241, 245, 1);
      border: 1px solid rgba(217, 216, 212, 1);
      color: #8e8e93;
      font-size: 13px;
      font-weight: 500;
    }
    .sources-pill-icons {
      display: flex;
      align-items: center;
      position: relative;
    }
    .sources-pill-icons .sources-pill-icon {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 600;
      color: #fff;
      border: 1.5px solid #2c2c2e;
      box-sizing: border-box;
    }
    .sources-pill-icons .sources-pill-icon:first-child {
      margin-right: -6px;
      z-index: 0;
    }
    .sources-pill-icons .sources-pill-icon:has(img) {
      background: none;
      border: none;
      padding: 0;
    }
    .sources-pill-icon-img {
      width: 20px;
      height: 20px;
      display: block;
      object-fit: contain;
    }
    .sources-pill-icons .sources-pill-icon:first-child svg {
      width: 10px;
      height: 10px;
    }
    .sources-pill-icons .sources-pill-icon:last-child {
      z-index: 1;
    }
    .sources-pill-icons .sources-pill-icon:last-child:not(:has(img)) {
      background: #fff;
      color: #4285f4;
    }
    .sources-icons {
      display: flex;
      align-items: center;
      gap: 8px;
      opacity: 0.4;
    }
    .sources-icons button {
      width: 24px;
      height: 24px;
      padding: 0;
      border: none;
      background: none;
      color: #0d0d0d;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }
    .sources-icons button:hover {
      background: #e3e7ea;
    }
    .sources-icons button svg {
      width: 16px;
      height: 16px;
    }

    /* Bottom bar – Figma 487-24847: single capsule, light gray */
    .input-area {
      flex-shrink: 0;
      background: #EFF1F5;
      padding: 12px 16px 40px;
    }
    .input-row {
      display: flex;
      align-items: center;
      gap: 12px;
      background: rgba(255, 255, 255, 0.85);
      border-radius: 24px;
      padding: 12px 16px 12px 12px;
      min-height: 52px;
      border: 1px solid #e3e7ea;
    }
    .input-btn-icon.tap-submit {
      animation: iconTap 0.32s ease-out;
    }
    @keyframes iconTap {
      0% { transform: scale(1); }
      18% { transform: scale(0.82); }
      45% { transform: scale(1.08); }
      100% { transform: scale(1); }
    }
    .input-btn-plus {
      width: 40px;
      height: 40px;
      min-width: 40px;
      border: none;
      border-radius: 50%;
      background: transparent;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      color: #0d0d0d;
    }
    .input-btn-plus svg {
      width: 24px;
      height: 24px;
    }
    .input-field {
      flex: 1;
      min-width: 0;
      border: none;
      background: transparent;
      font-size: 17px;
      font-weight: 400;
      line-height: 1.35;
      color: #0d0d0d;
      outline: none;
      resize: none;
      overflow-y: hidden;
      min-height: 24px;
      padding: 0;
      font-family: inherit;
    }
    .input-field::placeholder {
      color: #8f8f8f;
    }
    .input-btn-icon {
      width: 40px;
      height: 40px;
      min-width: 40px;
      border: none;
      background: none;
      padding: 0;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #0d0d0d;
    }
    .input-btn-icon svg {
      width: 24px;
      height: 24px;
    }
    .input-btn-icon .input-btn-icon-img {
      width: 100%;
      height: 100%;
    }

    /* Bottom drawer – slides up from bottom, inside phone frame */
    .drawer-overlay {
      position: absolute;
      inset: 0;
      z-index: 100;
      background: rgba(0, 0, 0, 0.4);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
      pointer-events: none;
    }
    .drawer-overlay.is-open {
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
    }
    .drawer-panel {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 101;
      height: 100%;
      background: #F8F7F1;
      border-radius: 0;
      box-shadow: 0 -4px 24px rgba(0, 0, 0, 0.12);
      transform: translateY(100%);
      transition: transform 0.35s cubic-bezier(0.32, 0.72, 0, 1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      isolation: isolate;
    }
    .drawer-overlay.is-open .drawer-panel {
      transform: translateY(0);
    }
    .drawer-handle {
      flex-shrink: 0;
      padding: 12px 0;
      display: flex;
      justify-content: center;
    }
    .drawer-handle::before {
      content: '';
      width: 36px;
      height: 4px;
      background: #c7c7cc;
      border-radius: 2px;
    }
    .drawer-header {
      flex-shrink: 0;
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 16px 16px 20px;
      background: #ffffff;
      border-bottom: 1px solid #e3e7ea;
    }
    .drawer-header-btn-left,
    .drawer-header-btn-right {
      flex-shrink: 0;
    }
    .drawer-title {
      flex: 1;
      min-width: 0;
      font-size: 17px;
      font-weight: 300;
      color: #0d0d0d;
      margin: 0;
      text-align: center;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .drawer-header-btn {
      width: 48px;
      height: 48px;
      min-width: 48px;
      min-height: 48px;
      border: none;
      background: transparent;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-wrap: nowrap;
      border-radius: 50%;
      overflow: hidden;
    }
    .drawer-header-btn img {
      width: 100%;
      height: 100%;
      display: flex;
      flex-wrap: wrap;
      object-fit: cover;
      border-radius: 50%;
    }
    .drawer-body {
      flex: 1;
      min-height: 0;
      overflow-y: auto;
      padding: 12px;
      padding-bottom: 180px;
      position: relative;
    }
    .drawer-footer {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      padding: 12px 16px 24px;
      background: rgba(255, 255, 255, 0.75);
      -webkit-backdrop-filter: blur(16px) saturate(1.2);
      backdrop-filter: blur(16px) saturate(1.2);
      border-top: 1px solid rgba(227, 231, 234, 0.6);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .drawer-footer-btn {
      width: 100%;
      padding: 14px 16px;
      border: none;
      border-radius: 12px;
      font-size: 17px;
      font-weight: 500;
      cursor: pointer;
      text-align: center;
      transition: background-color 0.2s ease, color 0.2s ease;
    }
    .drawer-footer-btn-secondary {
      background: rgba(255, 255, 255, 0);
      color: #376C68;
      border: 1px solid rgba(0, 0, 0, 0.1);
    }
    .drawer-footer-btn-secondary:hover {
      background: rgba(0, 0, 0, 0.05);
    }
    .drawer-footer-btn-primary {
      background: #2D5859;
      color: #fff;
    }
    .drawer-footer-btn-primary--twoline {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }
    .drawer-footer-btn-primary-line {
      display: block;
      line-height: 1.25;
    }
    .drawer-footer-btn-primary:hover {
      background: #244648;
    }
    .drawer-footer-btn {
      transition: transform 0.12s ease;
    }
    .drawer-footer-btn.demo-tap {
      transform: scale(0.96);
    }
    .drawer-footer-btns {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .drawer-footer-btns-confirm {
      display: none;
    }
    .drawer-overlay.drawer-after-loading .drawer-footer-btns-initial {
      display: none !important;
    }
    .drawer-overlay.drawer-after-loading .drawer-footer-btns-confirm {
      display: flex !important;
    }
    .drawer-footer-success {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 4px;
      padding: 20px 16px;
      text-align: center;
    }
    .drawer-success-text {
      margin: 0;
      font-size: 17px;
      font-weight: 600;
      color: #2D5859;
    }
    .drawer-success-sub {
      margin: 0;
      font-size: 15px;
      color: rgba(0, 0, 0, 0.6);
    }
    .drawer-overlay.drawer-showing-success .drawer-footer-btns-confirm {
      display: none !important;
    }
    .drawer-overlay.drawer-showing-success .drawer-footer-success {
      display: flex !important;
    }
    .drawer-card {
      border-radius: 24px;
      padding: 0;
      margin-bottom: 12px;
      position: relative;
      overflow: hidden;
      -webkit-transform: translateZ(0);
      transform: translateZ(0);
    }
    .drawer-card-video {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 24px;
      -webkit-transform: translateZ(0);
      transform: translateZ(0);
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
    }
    .drawer-card-overlay {
      position: absolute;
      inset: 0;
      background-color: unset;
      background: unset;
      background-image: none;
      border-radius: 24px;
      pointer-events: none;
    }
    .drawer-card-content {
      position: relative;
      z-index: 1;
      padding: 20px;
    }
    .drawer-card-title {
      font-size: 17px;
      font-weight: 600;
      color: #02363D;
      margin: 0 0 8px 0;
    }
    .drawer-card-desc {
      font-size: 15px;
      font-weight: 400;
      color: rgba(2, 54, 61, 0.85);
      line-height: 1.4;
      margin: 0 0 16px 0;
    }
    .drawer-card-label {
      font-size: 13px;
      font-weight: 400;
      color: rgba(2, 54, 61, 0.75);
      margin: 0 0 4px 0;
    }
    .drawer-card-price {
      font-size: 28px;
      font-weight: 600;
      color: #02363D;
      margin: 0 0 16px 0;
    }
    .drawer-card-verified {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      font-weight: 500;
      color: rgba(2, 54, 61, 0.85);
    }
    .drawer-card-verified-icon {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: #16696d;
      border: 1.5px solid #fff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    .drawer-card-verified-icon svg {
      width: 10px;
      height: 10px;
      stroke: #fff;
    }

    /* Drawer loading state – replaces cards, video bg + shiny text + progress bar */
    .drawer-body-cards.is-hidden {
      display: none !important;
    }
    .drawer-loading {
      display: none;
      position: absolute;
      inset: 0;
      border-radius: 24px;
      overflow: hidden;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 24px;
      padding: 24px;
      margin: 0 -12px;
    }
    .drawer-loading.is-visible {
      display: flex;
    }
    .drawer-loading-video {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 24px;
    }
    .drawer-loading-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.35);
      border-radius: 24px;
      pointer-events: none;
    }
    .drawer-loading-content {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      width: 400px;
      max-width: 400px;
    }
    .drawer-loading-text {
      width: 400px;
      font-size: 17px;
      font-weight: 500;
      line-height: 1.35;
      text-align: center;
      background: linear-gradient(
        90deg,
        #F8F7F1 0%,
        #F8F7F1 25%,
        #6BD5D1 50%,
        #F8F7F1 75%,
        #F8F7F1 100%
      );
      background-size: 200% 100%;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: drawerLoadingShimmer 1.8s ease-in-out infinite;
    }
    @keyframes drawerLoadingShimmer {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    .drawer-panel.is-loading .drawer-footer {
      display: none;
    }
    .drawer-loading-progress {
      width: 8px;
      height: 8px;
      background: rgba(255, 255, 255, 0.25);
      border-radius: 50%;
      overflow: hidden;
      transition: width 0.5s ease-out, height 0.35s ease-out, border-radius 0.4s ease-out;
    }
    .drawer-loading-progress.is-expanded {
      width: 100%;
      height: 4px;
      border-radius: 4px;
    }
    .drawer-loading-progress-bar {
      height: 100%;
      width: 40%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.9), transparent);
      border-radius: 4px;
      opacity: 0;
      transition: opacity 0.25s ease-out 0.4s;
    }
    .drawer-loading-progress.is-expanded .drawer-loading-progress-bar {
      opacity: 1;
      animation: drawerLoadingProgress 1.4s ease-in-out infinite;
    }
    @keyframes drawerLoadingProgress {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(350%); }
    }

    /* Second card: service + facility (Figma node 493:37940) */
    .drawer-card--service {
      background: #fff;
      padding: 0;
      border: 1px solid #E3E7EA;
    }
    .drawer-card-service-row {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
      padding: 16px 24px;
    }
    .drawer-card-service-row:first-child {
      padding-bottom: 12px;
    }
    .drawer-card-service-title {
      font-size: 17px;
      font-weight: 600;
      color: #121313;
      margin: 0;
      line-height: 1.3;
      flex: 1;
    }
    .drawer-card-meta {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      font-weight: 400;
      color: rgba(137, 152, 155, 0.7);
      flex-shrink: 0;
    }
    .drawer-card-meta-icon {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #e3e7ea;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      border: none;
      cursor: pointer;
      padding: 0;
    }
    .drawer-card-meta-icon svg {
      width: 12px;
      height: 12px;
      color: #89989b;
    }
    .drawer-card-divider {
      height: 1px;
      background: #e3e7ea;
      margin: 0 20px;
    }
    .drawer-card-facility {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 24px 16px;
    }
    .drawer-card-facility-icon {
      width: 24px;
      height: 24px;
      flex-shrink: 0;
      color: #c94d5c;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .drawer-card-facility-logo {
      width: 24px;
      height: 24px;
      object-fit: contain;
      display: block;
    }
    .drawer-card-facility-name {
      font-size: 15px;
      font-weight: 400;
      color: #121313;
      margin: 0;
      line-height: 1.4;
    }

    /* After loading: result card + benefits card visible (Figma 493-38252, 493-38318) */
    .drawer-card--result {
      display: none;
      background: #fff;
      padding: 0;
      border: 1px solid #E3E7EA;
      border-radius: 24px;
    }
    .drawer-card--benefits {
      display: none;
      background: #fff;
      padding: 0;
      border: 1px solid #E3E7EA;
      border-radius: 24px;
    }
    .drawer-card--tips {
      display: none;
      background: #2D5859;
      padding: 0;
      border: none;
      border-radius: 24px;
    }
    .drawer-overlay.drawer-after-loading .drawer-card:not(.drawer-card--result):not(.drawer-card--benefits):not(.drawer-card--tips) {
      display: none !important;
    }
    .drawer-overlay.drawer-after-loading .drawer-card--result,
    .drawer-overlay.drawer-after-loading .drawer-card--benefits,
    .drawer-overlay.drawer-after-loading .drawer-card--tips {
      display: block !important;
    }
    .drawer-overlay.drawer-after-loading .drawer-body-cards-helper {
      display: none !important;
    }
    .drawer-card-result-top {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 16px;
      padding: 16px 24px 12px;
    }
    .drawer-card-result-left {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
      min-width: 0;
    }
    .drawer-card-result-meta {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      font-weight: 400;
      color: rgba(137, 152, 155, 0.9);
    }
    .drawer-card-result-title {
      margin: 0;
      font-size: 17px;
      font-weight: 600;
      line-height: 1.3;
      color: #16696d;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 0;
    }
    .drawer-card-result-title-line {
      display: block;
    }
    .drawer-card-result-title-suffix {
      margin-top: 2px;
    }
    .drawer-card-result-price-block {
      text-align: right;
      flex-shrink: 0;
    }
    .drawer-card-result-price-label {
      display: block;
      font-size: 12px;
      font-weight: 400;
      color: rgba(137, 152, 155, 0.9);
      margin-bottom: 2px;
    }
    .drawer-card-result-price {
      font-size: 22px;
      font-weight: 600;
      color: #16696d;
    }
    .drawer-card--result .drawer-card-divider {
      margin: 0 24px;
    }
    .drawer-card-result-facility {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 12px 24px 16px;
    }
    .drawer-card-result-facility-info {
      flex: 1;
      min-width: 0;
    }
    .drawer-card-result-facility-info .drawer-card-facility-name {
      margin-bottom: 4px;
    }
    .drawer-card-result-address {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 13px;
      font-weight: 400;
      color: rgba(137, 152, 155, 0.9);
      margin: 0 0 8px 0;
      line-height: 1.4;
    }
    .drawer-card-result-pin {
      flex-shrink: 0;
      color: rgba(137, 152, 155, 0.9);
    }
    .drawer-card-result-stars {
      display: flex;
      align-items: center;
      gap: 2px;
      font-size: 14px;
      letter-spacing: 0.02em;
    }
    .drawer-card-result-star.filled {
      color: #d4a017;
    }
    .drawer-card-result-star:not(.filled) {
      color: #e3e7ea;
    }

    /* Benefits card after loading (Figma 493-38318) */
    .drawer-benefits-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 20px 24px 16px;
    }
    .drawer-benefits-plan {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 17px;
      font-weight: 600;
      color: #121313;
    }
    .drawer-benefits-plan-icon {
      width: 24px;
      height: 24px;
      flex-shrink: 0;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .drawer-benefits-plan-logo {
      width: 24px;
      height: 24px;
      object-fit: contain;
      display: block;
    }
    .drawer-benefits-edit {
      width: 32px;
      height: 32px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border: none;
      background: transparent;
      color: rgba(137, 152, 155, 0.8);
      cursor: pointer;
      padding: 0;
      border-radius: 8px;
    }
    .drawer-benefits-edit:hover {
      color: #121313;
      background: #f0f0f0;
    }
    .drawer-benefits-negotiated {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 0 24px 8px;
    }
    .drawer-benefits-negotiated-label {
      font-size: 15px;
      font-weight: 400;
      color: #121313;
    }
    .drawer-benefits-negotiated-value {
      font-size: 17px;
      font-weight: 600;
      color: rgba(25, 51, 59, 1);
    }
    .drawer-benefits-bar {
      display: flex;
      gap: 5px;
      height: 8px;
      border-radius: 4px;
      overflow: hidden;
      margin: 0 24px 16px;
      background: #e3e7ea;
    }
    .drawer-benefits-bar-teal {
      background: rgba(25, 51, 59, 1);
      border-radius: 142px;
      flex-shrink: 0;
    }
    .drawer-benefits-bar-purple {
      background: rgba(33, 140, 136, 1);
      border-radius: 144px;
      flex-shrink: 0;
    }
    .drawer-benefits-rows {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 0 24px 16px;
    }
    .drawer-benefits-row {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .drawer-benefits-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      flex-shrink: 0;
    }
    .drawer-benefits-dot--teal {
      background: #16696d;
    }
    .drawer-benefits-dot--purple {
      background: rgba(33, 140, 136, 1);
    }
    .drawer-benefits-row-label {
      flex: 1;
      font-size: 15px;
      font-weight: 400;
      color: #121313;
    }
    .drawer-benefits-row-value {
      font-size: 15px;
      font-weight: 600;
      color: #121313;
    }
    .drawer-benefits-value--teal {
      color: rgba(25, 51, 59, 1);
    }
    .drawer-benefits-breakdown {
      margin: 0 24px 16px;
      padding: 16px;
      background: #f5f6f7;
      border-radius: 12px;
    }
    .drawer-benefits-breakdown-header {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      width: 100%;
      margin: 0;
      padding: 0;
      border: none;
      background: none;
      cursor: pointer;
      text-align: left;
      font: inherit;
      color: inherit;
    }
    .drawer-benefits-breakdown-icon {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      margin-top: 2px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .drawer-benefits-breakdown-icon-img {
      width: 20px;
      height: 20px;
      object-fit: contain;
      display: block;
    }
    .drawer-benefits-breakdown-title-wrap {
      flex: 1;
      min-width: 0;
    }
    .drawer-benefits-breakdown-title {
      font-size: 15px;
      font-weight: 600;
      color: #121313;
      margin: 0 0 2px 0;
    }
    .drawer-benefits-breakdown-member {
      font-size: 13px;
      font-weight: 400;
      color: rgba(137, 152, 155, 0.9);
      margin: 0;
    }
    .drawer-benefits-breakdown-caret {
      flex-shrink: 0;
      color: rgba(137, 152, 155, 0.8);
      transition: transform 0.2s ease;
    }
    .drawer-benefits-breakdown:not(.is-collapsed) .drawer-benefits-breakdown-caret {
      transform: rotate(180deg);
    }
    .drawer-benefits-breakdown-body {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid #e3e7ea;
    }
    .drawer-benefits-breakdown.is-collapsed .drawer-benefits-breakdown-body {
      display: none;
    }
    .drawer-benefits-breakdown-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      padding: 4px 0;
    }
    .drawer-benefits-breakdown-label {
      font-size: 14px;
      font-weight: 400;
      color: #121313;
      border-bottom: 1px dotted rgba(18, 19, 19, 0.5);
    }
    .drawer-benefits-breakdown-val {
      font-size: 14px;
      font-weight: 500;
      color: #121313;
      flex-shrink: 0;
    }
    .drawer-benefits-note {
      font-size: 13px;
      font-weight: 400;
      color: rgba(137, 152, 155, 0.9);
      line-height: 1.45;
      margin: 0 24px 20px;
      padding: 0;
    }

    /* Tips card: estimated cost info (Figma 493-38467) */
    .drawer-tips-inner {
      display: flex;
      align-items: flex-start;
      gap: 14px;
      padding: 20px 24px;
    }
    .drawer-tips-icon-wrap {
      width: 40px;
      height: 40px;
      flex-shrink: 0;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .drawer-tips-icon {
      width: 24px;
      height: 24px;
      object-fit: contain;
      filter: brightness(0) invert(1);
    }
    .drawer-tips-content {
      flex: 1;
      min-width: 0;
    }
    .drawer-tips-message {
      font-size: 15px;
      font-weight: 600;
      color: #fff;
      line-height: 1.4;
      margin: 0 0 8px 0;
    }
    .drawer-tips-disclaimer {
      font-size: 14px;
      font-weight: 400;
      color: rgba(255, 255, 255, 0.75);
      line-height: 1.4;
      margin: 0;
    }

    /* Third card: Add your insurance benefits (Figma node 493:37956) */
    .drawer-card--insurance {
      background: #fff;
      padding: 0;
      border: 1px solid #e3e7ea;
      border-radius: 24px;
    }
    .drawer-insurance-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 24px;
    }
    .drawer-insurance-title {
      font-size: 17px;
      font-weight: 400;
      color: #121313;
      margin: 0;
      line-height: 1.3;
    }
    .drawer-insurance-optional {
      font-size: 11px;
      font-weight: 500;
      color: #8f8f8f;
      text-transform: uppercase;
      letter-spacing: 0.02em;
      padding: 4px 8px;
      background: #f0f0f0;
      border-radius: 6px;
      flex-shrink: 0;
    }
    .drawer-insurance-divider {
      height: 1px;
      background: #e3e7ea;
      margin: 0 20px;
    }
    .drawer-insurance-provider {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 16px 20px;
    }
    .drawer-insurance-provider-logo {
      width: 32px;
      height: 32px;
      border-radius: 6px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .drawer-insurance-provider-logo-img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    .drawer-insurance-provider-info {
      flex: 1;
      min-width: 0;
    }
    .drawer-insurance-provider-name {
      font-size: 15px;
      font-weight: 600;
      color: #121313;
      margin: 0 0 2px 0;
    }
    .drawer-insurance-provider-plan {
      font-size: 13px;
      font-weight: 400;
      color: #8f8f8f;
      margin: 0;
    }
    .drawer-insurance-provider-edit {
      width: 32px;
      height: 32px;
      border: none;
      background: transparent;
      border-radius: 50%;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: #8f8f8f;
      flex-shrink: 0;
    }
    .drawer-insurance-provider-edit:hover {
      background: #f0f0f0;
      color: #121313;
    }
    .drawer-insurance-form {
      padding: 0 20px 20px;
    }
    .drawer-insurance-field {
      margin-bottom: 14px;
    }
    .drawer-insurance-field:last-of-type {
      margin-bottom: 0;
    }
    .drawer-insurance-fields-row {
      display: flex;
      gap: 12px;
    }
    .drawer-insurance-fields-row .drawer-insurance-field {
      flex: 1;
    }
    .drawer-insurance-label {
      display: block;
      font-size: 13px;
      font-weight: 500;
      color: #121313;
      margin: 0 0 6px 0;
    }
    .drawer-insurance-input {
      width: 100%;
      box-sizing: border-box;
      font-size: 15px;
      font-weight: 400;
      color: #121313;
      background: #fff;
      border: 1px solid #e3e7ea;
      border-radius: 8px;
      padding: 10px 12px;
      font-family: inherit;
    }
    .drawer-insurance-input::placeholder {
      color: #8f8f8f;
    }
    .drawer-insurance-help {
      font-size: 13px;
      color: #8f8f8f;
      margin: 6px 0 0 0;
    }
    .drawer-insurance-help a {
      color: #16696d;
      text-decoration: none;
    }
    .drawer-insurance-help a:hover {
      text-decoration: underline;
    }
    .drawer-insurance-consent {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 40px 20px 40px;
      border-top: 1px solid #e3e7ea;
    }
    .drawer-insurance-consent-checkbox {
      width: 20px;
      height: 20px;
      border: 1.5px solid #e3e7ea;
      border-radius: 4px;
      flex-shrink: 0;
      cursor: pointer;
      appearance: none;
      background: #fff;
    }
    .drawer-insurance-consent-checkbox:checked {
      background: #16696d;
      border-color: #16696d;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'/%3E%3C/svg%3E");
    }
    .drawer-insurance-consent-text {
      font-size: 13px;
      font-weight: 400;
      color: #5c5c5c;
      margin: 0;
      line-height: 1.45;
    }
    .drawer-insurance-consent-text a {
      color: #16696d;
      text-decoration: none;
    }
    .drawer-insurance-consent-text a:hover {
      text-decoration: underline;
    }

    /* Replay / Skip – visible only when hovering bottom-right corner */
    .replay-actions {
      position: fixed;
      bottom: 0;
      right: 0;
      width: 160px;
      height: 80px;
      display: flex;
      align-items: flex-end;
      justify-content: flex-end;
      gap: 8px;
      padding: 0 24px 24px 0;
      z-index: 10;
    }
    .replay-btn, .skip-btn {
      padding: 10px 18px;
      font-size: 13px;
      font-weight: 500;
      font-family: inherit;
      color: #fff;
      background: #3a3a3c;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
    }
    .replay-actions:hover .replay-btn,
    .replay-actions:hover .skip-btn {
      opacity: 1;
      pointer-events: auto;
    }

    /* Concept toggle – visible only when hovering top-right corner */
    .concept-toggle {
      position: fixed;
      top: 0;
      right: 0;
      width: 200px;
      height: 80px;
      display: flex;
      align-items: flex-start;
      justify-content: flex-end;
      gap: 0;
      padding: 24px 24px 0 0;
      z-index: 10;
    }
    .concept-toggle-btn {
      padding: 8px 16px;
      font-size: 13px;
      font-weight: 500;
      font-family: inherit;
      color: rgba(255, 255, 255, 0.7);
      background: transparent;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: color 0.2s, background 0.2s, opacity 0.2s ease;
      opacity: 0;
      pointer-events: none;
    }
    .concept-toggle:hover .concept-toggle-btn {
      opacity: 1;
      pointer-events: auto;
    }
    .concept-toggle .concept-toggle-btn:first-child {
      border-radius: 8px 0 0 8px;
    }
    .concept-toggle .concept-toggle-btn:last-child {
      border-radius: 0 8px 8px 0;
    }
    .concept-toggle:hover .concept-toggle-btn {
      background: rgba(58, 58, 60, 0.9);
    }
    .concept-toggle-btn:hover {
      color: #fff;
    }
    .concept-toggle-btn.is-active {
      background: rgba(255, 255, 255, 0.2);
      color: #fff;
    }

    /* View toggle – top-left, visible on hover (Slides | Prototype) */
    .view-toggle {
      position: fixed;
      top: 0;
      left: 0;
      width: 200px;
      height: 80px;
      display: flex;
      align-items: flex-start;
      justify-content: flex-start;
      padding: 24px 0 0 24px;
      z-index: 11;
    }
    .view-toggle a,
    .view-toggle .view-toggle-btn {
      padding: 8px 16px;
      font-size: 13px;
      font-weight: 500;
      font-family: inherit;
      color: rgba(255, 255, 255, 0.7);
      background: rgba(58, 58, 60, 0.9);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: color 0.2s, background 0.2s, opacity 0.2s ease;
      opacity: 0;
      pointer-events: none;
      text-decoration: none;
      margin-right: 4px;
    }
    .view-toggle:hover a,
    .view-toggle:hover .view-toggle-btn {
      opacity: 1;
      pointer-events: auto;
    }
    .view-toggle a:hover,
    .view-toggle .view-toggle-btn:hover {
      color: #fff;
    }
    .view-toggle a.is-active {
      background: rgba(255, 255, 255, 0.2);
      color: #fff;
    }
  </style>
</head>
<body>
  <nav class="view-toggle" role="navigation" aria-label="View mode">
    <a href="index.html" class="view-toggle-btn is-active">Slides</a>
    <a href="prototype.html" class="view-toggle-btn">Prototype</a>
  </nav>

  <div class="slide-backdrop" id="slideBackdrop">
    <video id="bgVideo" muted loop playsinline webkit-playsinline>
      <source src="background.m4v" type="video/mp4">
      <source src="background.mp4" type="video/mp4">
      <source src="background.mov" type="video/quicktime">
    </video>
    <div id="bgVideoPrompt" class="bg-video-prompt">Tap to play background video</div>
  </div>
  <div class="slide-content">
    <div class="phone-frame-zoom-wrapper" id="phoneFrameWrapper">
    <div class="phone-frame initial" id="phoneFrame">
  <div class="top-bar">
    <header class="header">
      <div class="header-left">
        <button type="button" class="nav-icon" aria-label="Menu">
          <img src="assets/header-menu.png" alt="" class="header-icon-img">
        </button>
      </div>
      <div class="header-center">
        <img src="assets/header-sparkle.png" alt="" class="sparkle-icon header-icon-img">
        <span>AI</span>
      </div>
      <div class="header-right">
        <button type="button" class="nav-icon" aria-label="Chat">
          <img src="assets/header-chat.png" alt="" class="header-icon-img">
        </button>
      </div>
    </header>
  </div>

  <main class="chat-container" id="chatContainer"></main>

  <div class="input-area">
    <div class="input-row" id="inputRow">
      <button type="button" class="input-btn-plus" aria-label="Add">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
      </button>
      <textarea class="input-field" id="inputField" placeholder="Ask anything..." readonly rows="1"></textarea>
      <button type="button" class="input-btn-icon" aria-label="Microphone">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 1 3 3v6a3 3 0 0 1-6 0V5a3 3 0 0 1 3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="22"/><line x1="8" y1="22" x2="16" y2="22"/></svg>
      </button>
      <button type="button" class="input-btn-icon" id="submitIconBtn" aria-label="Audio">
        <img src="assets/audio-icon.png" alt="" class="input-btn-icon-img">
      </button>
    </div>
  </div>
    <div class="drawer-overlay" id="drawerOverlay" aria-hidden="true">
      <div class="drawer-panel">
        <div class="drawer-header">
          <button type="button" class="drawer-header-btn drawer-header-btn-left" id="drawerContentBtn" aria-label="View details">
            <img src="assets/drawer-content-btn.png" alt="">
          </button>
          <h2 class="drawer-title">turquoise.health/estimate/2099</h2>
          <button type="button" class="drawer-header-btn drawer-header-btn-right" id="drawerClose" aria-label="Close">
            <img src="assets/drawer-close-btn.png" alt="">
          </button>
        </div>
        <div class="drawer-body">
          <div class="drawer-body-cards" id="drawerBodyCards">
          <div class="drawer-card">
            <video id="drawerCardVideo" class="drawer-card-video" muted loop playsinline webkit-playsinline preload="auto" aria-hidden="true">
              <source src="background.mp4" type="video/mp4">
              <source src="background.m4v" type="video/mp4">
            </video>
            <div class="drawer-card-overlay" aria-hidden="true"></div>
            <div class="drawer-card-content">
              <h3 class="drawer-card-title">Estimated Price</h3>
              <p class="drawer-card-desc">This is the price you can expect to pay before your insurance benefits are applied.</p>
              <p class="drawer-card-label">Starting at</p>
              <p class="drawer-card-price">$3,896</p>
              <div class="drawer-card-verified">
                <span class="drawer-card-verified-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                </span>
                Fully verified
              </div>
            </div>
          </div>
          <div class="drawer-card drawer-card--service" aria-hidden="false">
            <div class="drawer-card-service-row">
              <h3 class="drawer-card-service-title">Labor &amp; Delivery (Vaginal)</h3>
              <span class="drawer-card-meta">
                SSP OB001
                <button type="button" class="drawer-card-meta-icon" aria-label="More information">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg>
                </button>
              </span>
            </div>
            <div class="drawer-card-divider" aria-hidden="true"></div>
            <div class="drawer-card-facility">
              <span class="drawer-card-facility-icon" aria-hidden="true">
                <img src="assets/ucla-health-logo.png" alt="" class="drawer-card-facility-logo">
              </span>
              <p class="drawer-card-facility-name">UCLA Health - Santa Monica Medical Center</p>
            </div>
          </div>
          <div class="drawer-card drawer-card--insurance">
            <div class="drawer-insurance-header">
              <h3 class="drawer-insurance-title">Add your insurance benefits</h3>
              <span class="drawer-insurance-optional">OPTIONAL</span>
            </div>
            <div class="drawer-insurance-divider" aria-hidden="true"></div>
            <div class="drawer-insurance-provider">
              <div class="drawer-insurance-provider-logo" aria-hidden="true">
                <img src="assets/cigna-logo.png" alt="" class="drawer-insurance-provider-logo-img">
              </div>
              <div class="drawer-insurance-provider-info">
                <p class="drawer-insurance-provider-name">Cigna</p>
                <p class="drawer-insurance-provider-plan">National OAP</p>
              </div>
              <button type="button" class="drawer-insurance-provider-edit" aria-label="Edit insurance">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
              </button>
            </div>
            <div class="drawer-insurance-form">
              <div class="drawer-insurance-fields-row">
                <div class="drawer-insurance-field">
                  <label class="drawer-insurance-label" for="drawer-first-name">First Name</label>
                  <input type="text" id="drawer-first-name" class="drawer-insurance-input" value="" placeholder="First name" maxlength="100">
                </div>
                <div class="drawer-insurance-field">
                  <label class="drawer-insurance-label" for="drawer-last-name">Last Name</label>
                  <input type="text" id="drawer-last-name" class="drawer-insurance-input" value="" placeholder="Last name" maxlength="100">
                </div>
              </div>
              <div class="drawer-insurance-field">
                <label class="drawer-insurance-label" for="drawer-dob">Date of Birth</label>
                <input type="text" id="drawer-dob" class="drawer-insurance-input" value="" placeholder="MM/DD/YYYY" maxlength="10">
              </div>
              <div class="drawer-insurance-field">
                <label class="drawer-insurance-label" for="drawer-member-id">Member ID</label>
                <input type="text" id="drawer-member-id" class="drawer-insurance-input" value="" placeholder="Member ID" maxlength="20">
                <p class="drawer-insurance-help"><a href="#">Where can I find this?</a></p>
              </div>
            </div>
            <div class="drawer-insurance-consent">
              <label for="drawer-insurance-consent" class="drawer-insurance-consent-text">I agree to share my personal information in accordance with <a href="#">Turquoise Health's Privacy Policy</a> & <a href="#">Consumer Terms of Use</a></label>
              <input type="checkbox" id="drawer-insurance-consent" class="drawer-insurance-consent-checkbox" aria-label="Agree to share personal information">
            </div>
          </div>
          <p class="drawer-body-cards-helper" style="font-size: 15px; color: #8f8f8f; margin: 0;">Update your details below to get a more accurate estimate for your care at UCLA Health.</p>
          <!-- First card shown after loading (Figma 493-38252): service + total you pay + facility + address + rating -->
          <div class="drawer-card drawer-card--result" id="drawerResultCard" aria-hidden="true">
            <div class="drawer-card-result-top">
              <div class="drawer-card-result-left">
                <span class="drawer-card-result-meta">
                  SSP OB001
                  <button type="button" class="drawer-card-meta-icon" aria-label="More information">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg>
                  </button>
                </span>
                <h3 class="drawer-card-result-title">
                  <span class="drawer-card-result-title-line">Labor &amp; Delivery</span>
                  <span class="drawer-card-result-title-line drawer-card-result-title-suffix">(Vaginal)</span>
                </h3>
              </div>
              <div class="drawer-card-result-price-block">
                <span class="drawer-card-result-price-label">Total you pay</span>
                <span class="drawer-card-result-price">$3,869</span>
              </div>
            </div>
            <div class="drawer-card-divider" aria-hidden="true"></div>
            <div class="drawer-card-result-facility">
              <span class="drawer-card-facility-icon" aria-hidden="true">
                <img src="assets/ucla-health-logo.png" alt="" class="drawer-card-facility-logo">
              </span>
              <div class="drawer-card-result-facility-info">
                <p class="drawer-card-facility-name">UCLA Health - Santa Monica Medical Center</p>
                <p class="drawer-card-result-address">
                  <svg class="drawer-card-result-pin" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14" aria-hidden="true"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
                  1250 16th Street, Santa Monica, CA 90404
                </p>
                <div class="drawer-card-result-stars" aria-label="4 out of 5 stars">
                  <span class="drawer-card-result-star filled" aria-hidden="true">★</span>
                  <span class="drawer-card-result-star filled" aria-hidden="true">★</span>
                  <span class="drawer-card-result-star filled" aria-hidden="true">★</span>
                  <span class="drawer-card-result-star filled" aria-hidden="true">★</span>
                  <span class="drawer-card-result-star" aria-hidden="true">★</span>
                </div>
              </div>
            </div>
          </div>
          <!-- Next card after loading: insurance benefits breakdown (Figma 493-38318) -->
          <div class="drawer-card drawer-card--benefits" id="drawerBenefitsCard" aria-hidden="true">
            <div class="drawer-benefits-header">
              <span class="drawer-benefits-plan">
                <span class="drawer-benefits-plan-icon" aria-hidden="true">
                  <img src="assets/cigna-benefits-logo.png" alt="" class="drawer-benefits-plan-logo">
                </span>
                Cigna National OAP
              </span>
              <button type="button" class="drawer-benefits-edit" aria-label="Edit insurance">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
              </button>
            </div>
            <div class="drawer-benefits-negotiated">
              <span class="drawer-benefits-negotiated-label">Total negotiated rate</span>
              <span class="drawer-benefits-negotiated-value">$17,340</span>
            </div>
            <div class="drawer-benefits-bar" role="presentation">
              <span class="drawer-benefits-bar-teal" style="width: 77.7%;"></span>
              <span class="drawer-benefits-bar-purple" style="width: 22.3%;"></span>
            </div>
            <div class="drawer-benefits-rows">
              <div class="drawer-benefits-row">
                <span class="drawer-benefits-dot drawer-benefits-dot--teal"></span>
                <span class="drawer-benefits-row-label">Total you pay</span>
                <span class="drawer-benefits-row-value drawer-benefits-value--teal">$3,869</span>
              </div>
              <div class="drawer-benefits-row">
                <span class="drawer-benefits-dot drawer-benefits-dot--purple"></span>
                <span class="drawer-benefits-row-label">Your insurance covers</span>
                <span class="drawer-benefits-row-value">-$13,471</span>
              </div>
            </div>
            <div class="drawer-benefits-breakdown is-collapsed" id="drawerBenefitsBreakdown">
              <button type="button" class="drawer-benefits-breakdown-header" id="drawerBenefitsBreakdownToggle" aria-expanded="false" aria-controls="drawerBenefitsBreakdownBody" aria-label="Your benefits breakdown, collapsed. Click to expand.">
                <span class="drawer-benefits-breakdown-icon" aria-hidden="true">
                  <img src="assets/shield-check.png" alt="" class="drawer-benefits-breakdown-icon-img">
                </span>
                <div class="drawer-benefits-breakdown-title-wrap">
                  <h4 class="drawer-benefits-breakdown-title">Your benefits breakdown</h4>
                  <p class="drawer-benefits-breakdown-member">Member ID: 11000362778</p>
                </div>
                <span class="drawer-benefits-breakdown-caret" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><polyline points="6 9 12 15 18 9"/></svg>
                </span>
              </button>
              <div class="drawer-benefits-breakdown-body" id="drawerBenefitsBreakdownBody">
                <div class="drawer-benefits-breakdown-row">
                  <span class="drawer-benefits-breakdown-label">Deductible</span>
                  <span class="drawer-benefits-breakdown-val">Met</span>
                </div>
                <div class="drawer-benefits-breakdown-row">
                  <span class="drawer-benefits-breakdown-label">Out-of-pocket max remaining</span>
                  <span class="drawer-benefits-breakdown-val">$500</span>
                </div>
                <div class="drawer-benefits-breakdown-row">
                  <span class="drawer-benefits-breakdown-label">Your co-insurance</span>
                  <span class="drawer-benefits-breakdown-val">$3,869</span>
                </div>
              </div>
            </div>
            <p class="drawer-benefits-note">Since you've already met your deductible and are close to your out-of-pocket max, you only pay the remaining amount based on your co-insurance.</p>
          </div>
          <!-- Tips card: estimated cost info (Figma 493-38467) -->
          <div class="drawer-card drawer-card--tips" id="drawerTipsCard" aria-hidden="true">
            <div class="drawer-tips-inner">
              <span class="drawer-tips-icon-wrap" aria-hidden="true">
                <img src="assets/lightbulb.png" alt="" class="drawer-tips-icon">
              </span>
              <div class="drawer-tips-content">
                <p class="drawer-tips-message">Your estimated cost is calculated using your insurance coverage and current negotiated rates.</p>
                <p class="drawer-tips-disclaimer">Final charges may vary based on services provided.</p>
              </div>
            </div>
          </div>
          </div>
          <div class="drawer-loading" id="drawerLoading" aria-live="polite" aria-busy="true" hidden>
            <video class="drawer-loading-video" id="drawerLoadingVideo" muted loop playsinline webkit-playsinline aria-hidden="true">
              <source src="background.m4v" type="video/mp4">
              <source src="background.mp4" type="video/mp4">
              <source src="background.mov" type="video/quicktime">
            </video>
            <div class="drawer-loading-overlay" aria-hidden="true"></div>
            <div class="drawer-loading-content">
              <p class="drawer-loading-text">One sec, we're verifying your coverage</p>
              <div class="drawer-loading-progress" role="progressbar" aria-label="Verifying coverage" aria-valuetext="In progress">
                <div class="drawer-loading-progress-bar"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="drawer-footer">
          <div class="drawer-footer-btns drawer-footer-btns-initial">
            <button type="button" class="drawer-footer-btn drawer-footer-btn-secondary">Skip for now</button>
            <button type="button" class="drawer-footer-btn drawer-footer-btn-primary" id="drawerApplyBtn">Apply my benefits</button>
          </div>
          <div class="drawer-footer-btns drawer-footer-btns-confirm">
            <button type="button" class="drawer-footer-btn drawer-footer-btn-secondary" id="drawerCancelBtn">Cancel</button>
            <button type="button" class="drawer-footer-btn drawer-footer-btn-primary drawer-footer-btn-primary--twoline" id="drawerConfirmEstimateBtn"><span class="drawer-footer-btn-primary-line">Confirm</span><span class="drawer-footer-btn-primary-line">estimate</span></button>
          </div>
          <div class="drawer-footer-success" id="drawerFooterSuccess" aria-live="polite">
            <p class="drawer-success-text">Estimate confirmed!</p>
            <p class="drawer-success-sub">Taking you back to chat...</p>
          </div>
        </div>
      </div>
    </div>
    </div>
    </div>
  </div>

  <div class="concept-toggle" role="group" aria-label="Demo concept">
    <button type="button" class="concept-toggle-btn is-active" id="concept1Btn" data-concept="1">Concept 1</button>
    <button type="button" class="concept-toggle-btn" id="concept2Btn" data-concept="2">Concept 2</button>
    <button type="button" class="concept-toggle-btn" id="concept3Btn" data-concept="3">Concept 3</button>
  </div>

  <div class="replay-actions">
    <button type="button" class="skip-btn" id="skipBtn">Skip animation</button>
    <button type="button" class="replay-btn" id="replayBtn">Replay animation</button>
  </div>

  <script>
    const chatContainer = document.getElementById('chatContainer');
    const phoneFrame = document.getElementById('phoneFrame');
    const phoneFrameWrapper = document.getElementById('phoneFrameWrapper');
    const submitIconBtn = document.getElementById('submitIconBtn');
    const replayBtn = document.getElementById('replayBtn');
    const skipBtn = document.getElementById('skipBtn');
    const inputField = document.getElementById('inputField');
    const drawerOverlay = document.getElementById('drawerOverlay');
    const drawerClose = document.getElementById('drawerClose');
    const bgVideo = document.getElementById('bgVideo');
    const bgVideoPrompt = document.getElementById('bgVideoPrompt');

    function playBgVideo() {
      if (!bgVideo) return;
      const p = bgVideo.play();
      if (p && p.catch) p.catch(function() {});
      if (bgVideoPrompt) bgVideoPrompt.classList.remove('visible');
    }

    if (bgVideo) {
      bgVideo.addEventListener('loadeddata', playBgVideo);
      bgVideo.addEventListener('canplay', playBgVideo);
      playBgVideo();
      setTimeout(function() {
        if (bgVideo.paused && bgVideoPrompt) bgVideoPrompt.classList.add('visible');
      }, 800);
      bgVideo.addEventListener('error', function() {
        if (bgVideoPrompt) {
          bgVideoPrompt.textContent = 'Tap to play background video';
          bgVideoPrompt.classList.add('visible');
        }
      });
    }
    if (bgVideoPrompt) {
      document.body.addEventListener('click', function startVideoOnce() {
        playBgVideo();
        document.body.removeEventListener('click', startVideoOnce);
      }, { once: true });
    }

    var currentConcept = 1;
    var concept2Cancelled = false;

    var concept2Questions = [
      "How much does an MRI cost near me?",
      "I need a colonoscopy soon — what will I actually pay with Cigna?",
      "Is it cheaper to go to an imaging center or a hospital for an X-ray?",
      "What does it cost to have a baby in California with insurance?",
      "I tore my ACL. How much does surgery usually cost out of pocket?",
      "My doctor ordered a CT scan. Can you tell me what that might cost?",
      "Here's my insurance — how much would a hand X-ray cost?",
      "Can you help me schedule a colonoscopy and tell me the total cost upfront?",
      "How much does it cost to have a baby in LA? Like realistically.",
      "I have Cigna. What would I owe for ACL surgery?"
    ];

    const userPrompt = "How much does it cost to have a baby at UCLA?";
    const aiResponseParts = [
      { type: 'text', content: "The total cost of a vaginal birth at UCLA Health in Santa Monica with Dr. Nguyen can be from $6,000 to $17,000 with your Cigna plan. But because you have insurance coverage, your out-of-pocket costs will be closer to " },
      { type: 'bold', content: "$2,000-$6,000" },
      { type: 'text', content: ".\n\nLet me know if the following has changed and I can update your estimate. Also, if you'd like to see the cost of a Cesarean delivery, I can calculate that for you too.\n\n" },
      { type: 'bullets', items: ["Your insurance plan", "The type of birth you're hoping to have (vaginal or cesarean)", "If your preferred provider has changed at UCLA"] },
      { type: 'text', content: "\n\nClick on " },
      { type: 'bold', content: "personalize estimate" },
      { type: 'text', content: " to enter your insurance details on Turquoise. I can also show you other providers near UCLA if you'd like to compare costs — just let me know!" },
      { type: 'card' },
      { type: 'sources' }
    ];

    function createUserBubble() {
      const wrap = document.createElement('div');
      wrap.className = 'message user';
      wrap.innerHTML = `<div class="bubble user"><span class="user-text"></span></div>`;
      return wrap;
    }

    function createAssistantLoading() {
      const wrap = document.createElement('div');
      wrap.className = 'message assistant';
      wrap.innerHTML = `
        <div class="bubble assistant">
          <div class="loading-text">Fetching data from Turquoise Health<span class="loading-ellipsis"><span>.</span><span>.</span><span>.</span></span></div>
        </div>
      `;
      return wrap;
    }

    function createProviderCard() {
      const card = document.createElement('div');
      card.className = 'provider-card';
      card.innerHTML = `
        <div class="provider-card-section">
          <div class="provider-card-header">
            <span class="provider-card-title">UCLA Health - Santa Monica Medical Ce...</span>
            <span class="provider-card-rating">4.8<span class="star">★</span></span>
          </div>
          <div class="provider-card-category">Labor & Delivery</div>
          <div class="provider-card-meta">
            <span class="provider-card-pill">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
              Cigna
            </span>
            <div class="provider-cost-block">
              <span class="provider-cost-label">Start at*</span>
              <span class="provider-cost-value">$3,896</span>
            </div>
          </div>
        </div>
        <hr class="provider-card-divider">
        <div class="provider-card-section">
          <div class="provider-doctor">
            <div class="provider-doctor-avatar" style="background-image:url('doc-avatar.png');"></div>
            <div>
              <div class="provider-doctor-name">Dr. Emily Nguyen, MD, FACOG</div>
              <div class="provider-doctor-spec">Obstetrics & Gynecology</div>
            </div>
          </div>
        </div>
        <hr class="provider-card-divider">
        <div class="provider-card-section">
          <button type="button" class="btn-primary">Personalize Estimate</button>
          <div class="provider-disclaimer">Prices are estimates until confirmed via Turquoise Health.</div>
        </div>
      `;
      return card;
    }

    function createSourcesBlock() {
      const wrap = document.createElement('div');
      wrap.className = 'sources-block';
      wrap.innerHTML = `
        <a href="#" class="sources-link">Turquoise Health &gt;</a>
        <div class="sources-desc">Healthcare data and technology company focused on price transparency and healthcare cost information.</div>
        <div class="sources-row">
          <div class="sources-pill">
            <span class="sources-pill-text">Sources</span>
            <div class="sources-pill-icons">
              <span class="sources-pill-icon" aria-hidden="true"><img src="assets/sources-add-icon.png" alt="" class="sources-pill-icon-img"></span>
              <span class="sources-pill-icon" aria-hidden="true"><img src="assets/google-icon.png" alt="" class="sources-pill-icon-img"></span>
            </div>
          </div>
          <div class="sources-icons">
          <button type="button" aria-label="Copy"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
          <button type="button" aria-label="Share"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg></button>
          <button type="button" aria-label="Play"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg></button>
          <button type="button" aria-label="Like"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"/></svg></button>
          <button type="button" aria-label="Dislike"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h3a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2h-3"/></svg></button>
          <button type="button" aria-label="Refresh"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/></svg></button>
          </div>
        </div>
      `;
      return wrap;
    }

    function getEstimateSummaryFromDrawer() {
      var resultCard = document.getElementById('drawerResultCard');
      if (!resultCard) return { procedure: 'your procedure', totalPay: '', facility: '' };
      var titleEl = resultCard.querySelector('.drawer-card-result-title');
      var procedure = titleEl ? (titleEl.textContent || '').trim().replace(/\s+/g, ' ') || 'your procedure' : 'your procedure';
      var priceEl = resultCard.querySelector('.drawer-card-result-price');
      var totalPay = priceEl ? (priceEl.textContent || '').trim() : '';
      var facilityEl = resultCard.querySelector('.drawer-card-facility-name');
      var facility = facilityEl ? (facilityEl.textContent || '').trim() : '';
      return { procedure: procedure, totalPay: totalPay, facility: facility };
    }

    function appendCongratsMessage(summary) {
      var procedure = summary.procedure || 'your procedure';
      var totalPay = summary.totalPay || '';
      var facility = summary.facility || '';
      var aiWrap = document.createElement('div');
      aiWrap.className = 'message assistant';
      var bubble = document.createElement('div');
      bubble.className = 'bubble assistant';
      var p1 = document.createElement('p');
      p1.textContent = "Congratulations on getting your estimate! We're glad we could help you understand your costs.";
      bubble.appendChild(p1);
      var p2 = document.createElement('p');
      p2.textContent = "Wishing you the best with your procedure — take care!";
      bubble.appendChild(p2);
      var p3 = document.createElement('p');
      p3.textContent = "Here's a quick summary of what you confirmed:";
      bubble.appendChild(p3);
      var ul = document.createElement('ul');
      var li1 = document.createElement('li');
      li1.textContent = "Procedure: " + procedure;
      ul.appendChild(li1);
      if (totalPay) {
        var li2 = document.createElement('li');
        li2.textContent = "Total you pay: " + totalPay;
        ul.appendChild(li2);
      }
      if (facility) {
        var li3 = document.createElement('li');
        li3.textContent = "Facility: " + facility;
        ul.appendChild(li3);
      }
      bubble.appendChild(ul);
      aiWrap.appendChild(bubble);
      chatContainer.appendChild(aiWrap);
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function appendPartToBubble(bubble, part) {
      if (part.type === 'text' || part.type === 'bold') {
        const words = part.content.split(/(\s+)/);
        words.forEach(function(word) {
          if (word === '\n\n') {
            bubble.appendChild(document.createElement('br'));
            bubble.appendChild(document.createElement('br'));
          } else if (word === '\n') {
            bubble.appendChild(document.createElement('br'));
          } else {
            const el = document.createElement(part.type === 'bold' ? 'strong' : 'span');
            el.appendChild(document.createTextNode(word));
            bubble.appendChild(el);
          }
        });
      } else if (part.type === 'bullets') {
        const ul = document.createElement('ul');
        part.items.forEach(function(item) {
          const li = document.createElement('li');
          li.textContent = item;
          ul.appendChild(li);
        });
        bubble.appendChild(ul);
      } else if (part.type === 'card') {
        bubble.appendChild(createProviderCard());
      } else if (part.type === 'sources') {
        bubble.appendChild(createSourcesBlock());
      }
    }

    function skipDemo() {
      chatContainer.innerHTML = '';
      inputField.value = '';
      inputField.placeholder = 'Ask anything...';
      if (phoneFrame) {
        phoneFrame.classList.remove('initial');
        phoneFrame.style.height = '956px';
      }
      if (phoneFrameWrapper) {
        phoneFrameWrapper.classList.remove('zoom-in-top');
        phoneFrameWrapper.style.transition = '';
      }
      var userMsg = createUserBubble();
      chatContainer.appendChild(userMsg);
      userMsg.querySelector('.user-text').textContent = userPrompt;
      var aiWrap = document.createElement('div');
      aiWrap.className = 'message assistant';
      var bubble = document.createElement('div');
      bubble.className = 'bubble assistant';
      aiWrap.appendChild(bubble);
      chatContainer.appendChild(aiWrap);
      aiResponseParts.forEach(function(part) {
        appendPartToBubble(bubble, part);
      });
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function resizeInputForConcept2() {
      inputField.style.height = '0';
      inputField.style.height = Math.max(24, inputField.scrollHeight) + 'px';
    }

    function typeQuestionIntoInput(text, onDone) {
      inputField.placeholder = '';
      var i = 0;
      function addChar() {
        if (concept2Cancelled) return;
        if (i < text.length) {
          inputField.value = text.slice(0, i + 1);
          resizeInputForConcept2();
          i++;
          setTimeout(addChar, 50);
        } else {
          resizeInputForConcept2();
          if (onDone) onDone();
        }
      }
      addChar();
    }

    function eraseInputField(onDone) {
      function removeChar() {
        if (concept2Cancelled) return;
        var current = inputField.value;
        if (current.length === 0) {
          inputField.placeholder = 'Ask anything...';
          resizeInputForConcept2();
          if (onDone) onDone();
          return;
        }
        inputField.value = current.slice(0, current.length - 1);
        resizeInputForConcept2();
        setTimeout(removeChar, 35);
      }
      removeChar();
    }

    function runDemoConcept2() {
      concept2Cancelled = false;
      var questionIndex = 0;

      function runNextQuestion() {
        if (concept2Cancelled) return;
        var text = concept2Questions[questionIndex];
        questionIndex = (questionIndex + 1) % concept2Questions.length;

        typeQuestionIntoInput(text, function() {
          if (concept2Cancelled) return;
          setTimeout(function() {
            if (concept2Cancelled) return;
            eraseInputField(function() {
              if (concept2Cancelled) return;
              setTimeout(runNextQuestion, 900);
            });
          }, 2200);
        });
      }

      setTimeout(runNextQuestion, 1500);
    }

    function runDemo() {
      concept2Cancelled = false;
      chatContainer.innerHTML = '';
      inputField.value = '';
      inputField.placeholder = 'Ask anything...';
      if (phoneFrame) {
        phoneFrame.classList.add('initial');
        phoneFrame.style.height = '';
      }
      if (phoneFrameWrapper) {
        phoneFrameWrapper.style.transition = 'none';
        phoneFrameWrapper.style.transform = 'scale(1)';
        phoneFrameWrapper.classList.remove('zoom-in-top', 'zoom-drawer-open', 'zoom-final');
        requestAnimationFrame(function() {
          phoneFrameWrapper.style.transition = '';
          phoneFrameWrapper.style.transform = '';
        });
      }

      if (currentConcept === 2) {
        inputField.placeholder = 'Ask anything...';
        runDemoConcept2();
        return;
      }

      let inputIdx = 0;
      function resizeInput() {
        inputField.style.height = 'auto';
        inputField.style.height = Math.max(24, inputField.scrollHeight) + 'px';
      }
      function typeInInput() {
        if (inputIdx <= userPrompt.length) {
          inputField.value = userPrompt.slice(0, inputIdx);
          resizeInput();
          inputIdx++;
          setTimeout(typeInInput, 40);
        } else {
          if (submitIconBtn) {
            submitIconBtn.classList.add('tap-submit');
            setTimeout(() => {
              if (submitIconBtn) submitIconBtn.classList.remove('tap-submit');
              setTimeout(() => {
                inputField.value = '';
                inputField.placeholder = 'Ask anything...';
                resizeInput();
                showUserBubble();
              }, 180);
            }, 320);
          } else {
            setTimeout(() => {
              inputField.value = '';
              inputField.placeholder = 'Ask anything...';
              resizeInput();
              showUserBubble();
            }, 350);
          }
        }
      }
      setTimeout(typeInInput, 1500);
    }

    function showUserBubble() {
      if (phoneFrame) {
        var h = phoneFrame.offsetHeight;
        phoneFrame.classList.remove('initial');
        phoneFrame.style.height = h + 'px';
        requestAnimationFrame(function() {
          phoneFrame.style.height = '956px';
          if (currentConcept === 3) {
          } else if (phoneFrameWrapper) {
            phoneFrameWrapper.style.transition = '';
            setTimeout(function() {
              phoneFrameWrapper.classList.add('zoom-in-top');
              setTimeout(function() {
                phoneFrameWrapper.style.transition = 'transform 11s ease-in-out';
                phoneFrameWrapper.classList.remove('zoom-in-top');
                phoneFrameWrapper.addEventListener('transitionend', function onZoomOutEnd(e) {
                  if (e.propertyName !== 'transform') return;
                  phoneFrameWrapper.removeEventListener('transitionend', onZoomOutEnd);
                  phoneFrameWrapper.style.transition = '';
                  startDrawerSequence();
                });
              }, 1300);
            }, 520);
          }
        });
      }
      const userMsg = createUserBubble();
      chatContainer.appendChild(userMsg);
      userMsg.querySelector('.user-text').textContent = userPrompt;
      chatContainer.scrollTop = chatContainer.scrollHeight;

      setTimeout(() => {
        const loadingMsg = createAssistantLoading();
        chatContainer.appendChild(loadingMsg);
        chatContainer.scrollTop = chatContainer.scrollHeight;

        setTimeout(() => {
          loadingMsg.remove();
          const aiWrap = document.createElement('div');
          aiWrap.className = 'message assistant';
          const bubble = document.createElement('div');
          bubble.className = 'bubble assistant';
          aiWrap.appendChild(bubble);
          chatContainer.appendChild(aiWrap);
          chatContainer.scrollTop = chatContainer.scrollHeight;

          let partIndex = 0;
          let wordIndex = 0;
          let currentWords = [];

          function streamNext() {
            if (partIndex >= aiResponseParts.length) {
              chatContainer.scrollTop = chatContainer.scrollHeight;
              if (currentConcept === 3) {
                setTimeout(startDrawerSequence, 800);
              }
              return;
            }
            const part = aiResponseParts[partIndex];
            if (part.type === 'text' || part.type === 'bold') {
              if (wordIndex === 0) currentWords = part.content.split(/(\s+)/);
              if (wordIndex < currentWords.length) {
                const word = currentWords[wordIndex];
                if (word === '\n\n') {
                  bubble.appendChild(document.createElement('br'));
                  bubble.appendChild(document.createElement('br'));
                } else if (word === '\n') {
                  bubble.appendChild(document.createElement('br'));
                } else {
                  const el = document.createElement(part.type === 'bold' ? 'strong' : 'span');
                  el.appendChild(document.createTextNode(word));
                  bubble.appendChild(el);
                }
                wordIndex++;
                chatContainer.scrollTop = chatContainer.scrollHeight;
                setTimeout(streamNext, 38);
              } else {
                partIndex++;
                wordIndex = 0;
                setTimeout(streamNext, 20);
              }
            } else if (part.type === 'bullets') {
              const ul = document.createElement('ul');
              part.items.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                ul.appendChild(li);
              });
              bubble.appendChild(ul);
              partIndex++;
              chatContainer.scrollTop = chatContainer.scrollHeight;
              setTimeout(streamNext, 30);
            } else if (part.type === 'card') {
              bubble.appendChild(createProviderCard());
              partIndex++;
              chatContainer.scrollTop = chatContainer.scrollHeight;
              setTimeout(streamNext, 30);
            } else if (part.type === 'sources') {
              bubble.appendChild(createSourcesBlock());
              partIndex++;
              chatContainer.scrollTop = chatContainer.scrollHeight;
              setTimeout(streamNext, 30);
            }
          }
          streamNext();
        }, 1600);
      }, 500);
    }

    function startDrawerSequence() {
      setTimeout(function() {
        var personalizeBtn = chatContainer.querySelector('.provider-card .btn-primary');
        if (!personalizeBtn || !drawerOverlay) return;
        chatContainer.scrollTop = chatContainer.scrollHeight;
        personalizeBtn.classList.add('demo-tap');
        setTimeout(function() {
          if (currentConcept !== 3 && phoneFrameWrapper) {
            phoneFrameWrapper.style.transition = 'transform 0.45s ease-out';
            phoneFrameWrapper.classList.add('zoom-drawer-open');
          }
          personalizeBtn.click();
          setTimeout(function() {
            personalizeBtn.classList.remove('demo-tap');
          }, 120);
          setTimeout(runDrawerFormSequence, 400);
          if (currentConcept !== 3 && phoneFrameWrapper) {
            setTimeout(function() {
              phoneFrameWrapper.style.transition = 'transform 10s ease-in-out';
              phoneFrameWrapper.classList.remove('zoom-drawer-open');
              phoneFrameWrapper.addEventListener('transitionend', function onDrawerZoomOut(e) {
                if (e.propertyName !== 'transform') return;
                phoneFrameWrapper.removeEventListener('transitionend', onDrawerZoomOut);
                phoneFrameWrapper.style.transition = '';
              });
            }, 600);
          }
        }, 200);
      }, 700);
    }

    var drawerFormDemoValues = ['Meredith', 'Palmer', '01/01/1980', '11000362778'];
    var drawerFormDemoFieldIds = ['drawer-first-name', 'drawer-last-name', 'drawer-dob', 'drawer-member-id'];

    function typeIntoField(inputEl, text, onDone) {
      if (!inputEl || text.length === 0) {
        if (onDone) onDone();
        return;
      }
      var i = 0;
      function addChar() {
        if (i < text.length) {
          inputEl.value = text.slice(0, i + 1);
          inputEl.dispatchEvent(new Event('input', { bubbles: true }));
          i++;
          setTimeout(addChar, 65);
        } else {
          if (onDone) onDone();
        }
      }
      addChar();
    }

    function runDrawerFormSequence() {
      var drawerBody = drawerPanel ? drawerPanel.querySelector('.drawer-body') : null;
      if (!drawerBody) return;
      var insuranceCard = drawerBody.querySelector('.drawer-card--insurance');
      var consentId = 'drawer-insurance-consent';
      var step = 0;

      function typeFieldThenNext(el, text, next) {
        if (!el) {
          next();
          return;
        }
        el.value = '';
        el.focus();
        typeIntoField(el, text, function() {
          setTimeout(next, 350);
        });
      }

      function runNext() {
        if (step < drawerFormDemoFieldIds.length) {
          var fieldId = drawerFormDemoFieldIds[step];
          var text = drawerFormDemoValues[step];
          step++;
          typeFieldThenNext(document.getElementById(fieldId), text, runNext);
        } else {
          var checkbox = document.getElementById(consentId);
          if (checkbox) {
            checkbox.scrollIntoView({ behavior: 'smooth', block: 'center' });
            setTimeout(function() {
              checkbox.checked = true;
              checkbox.focus();
              var applyBtn = document.getElementById('drawerApplyBtn');
              if (applyBtn) {
                setTimeout(function() {
                  applyBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
                  setTimeout(function() {
                    applyBtn.classList.add('demo-tap');
                    applyBtn.click();
                    setTimeout(function() {
                      applyBtn.classList.remove('demo-tap');
                    }, 120);
                  }, 600);
                }, 800);
              }
            }, 450);
          }
        }
      }

      function startFillingForm() {
        setTimeout(runNext, 400);
      }

      if (insuranceCard) {
        setTimeout(function() {
          insuranceCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
          setTimeout(startFillingForm, 800);
        }, 1500);
      } else {
        startFillingForm();
      }
    }

    const drawerCardVideo = document.getElementById('drawerCardVideo');
    const drawerBodyCards = document.getElementById('drawerBodyCards');
    const drawerLoading = document.getElementById('drawerLoading');
    const drawerLoadingVideo = document.getElementById('drawerLoadingVideo');
    const drawerLoadingProgress = document.querySelector('.drawer-loading-progress');
    const drawerPanel = drawerOverlay ? drawerOverlay.querySelector('.drawer-panel') : null;
    const drawerApplyBtn = document.getElementById('drawerApplyBtn');
    const drawerCancelBtn = document.getElementById('drawerCancelBtn');
    const drawerBenefitsBreakdown = document.getElementById('drawerBenefitsBreakdown');
    const drawerBenefitsBreakdownToggle = document.getElementById('drawerBenefitsBreakdownToggle');

    function openDrawer() {
      if (drawerOverlay) {
        drawerOverlay.classList.add('is-open');
        drawerOverlay.classList.remove('drawer-after-loading');
        drawerOverlay.setAttribute('aria-hidden', 'false');
      }
      if (drawerPanel) drawerPanel.classList.remove('is-loading');
      if (drawerLoadingProgress) drawerLoadingProgress.classList.remove('is-expanded');
      if (drawerCardVideo) {
        drawerCardVideo.playsInline = true;
        drawerCardVideo.muted = true;
        drawerCardVideo.load();
        var p = drawerCardVideo.play();
        if (p && p.catch) p.catch(function() {});
      }
      if (drawerBodyCards) drawerBodyCards.classList.remove('is-hidden');
      if (drawerLoading) {
        drawerLoading.classList.remove('is-visible');
        drawerLoading.setAttribute('hidden', '');
        if (drawerLoadingVideo) drawerLoadingVideo.pause();
      }
      var resultCard = document.getElementById('drawerResultCard');
      var benefitsCard = document.getElementById('drawerBenefitsCard');
      var tipsCard = document.getElementById('drawerTipsCard');
      if (resultCard) resultCard.setAttribute('aria-hidden', 'true');
      if (benefitsCard) benefitsCard.setAttribute('aria-hidden', 'true');
      if (tipsCard) tipsCard.setAttribute('aria-hidden', 'true');
    }
    function closeDrawer() {
      if (drawerOverlay) {
        drawerOverlay.classList.remove('is-open', 'drawer-after-loading', 'drawer-showing-success');
        drawerOverlay.setAttribute('aria-hidden', 'true');
      }
      if (drawerPanel) drawerPanel.classList.remove('is-loading');
      if (drawerLoadingProgress) drawerLoadingProgress.classList.remove('is-expanded');
      if (drawerCardVideo) drawerCardVideo.pause();
      if (drawerBodyCards) drawerBodyCards.classList.remove('is-hidden');
      if (drawerLoading) {
        drawerLoading.classList.remove('is-visible');
        drawerLoading.setAttribute('hidden', '');
        if (drawerLoadingVideo) drawerLoadingVideo.pause();
      }
      var resultCard = document.getElementById('drawerResultCard');
      var benefitsCard = document.getElementById('drawerBenefitsCard');
      var tipsCard = document.getElementById('drawerTipsCard');
      if (resultCard) resultCard.setAttribute('aria-hidden', 'true');
      if (benefitsCard) benefitsCard.setAttribute('aria-hidden', 'true');
      if (tipsCard) tipsCard.setAttribute('aria-hidden', 'true');
    }
    function showDrawerResultCard() {
      if (drawerPanel) drawerPanel.classList.remove('is-loading');
      if (drawerLoading) {
        drawerLoading.classList.remove('is-visible');
        drawerLoading.setAttribute('hidden', '');
        if (drawerLoadingVideo) drawerLoadingVideo.pause();
      }
      if (drawerBodyCards) drawerBodyCards.classList.remove('is-hidden');
      if (drawerOverlay) drawerOverlay.classList.add('drawer-after-loading');
      var resultCard = document.getElementById('drawerResultCard');
      var benefitsCard = document.getElementById('drawerBenefitsCard');
      var tipsCard = document.getElementById('drawerTipsCard');
      if (resultCard) resultCard.setAttribute('aria-hidden', 'false');
      if (benefitsCard) benefitsCard.setAttribute('aria-hidden', 'false');
      if (tipsCard) tipsCard.setAttribute('aria-hidden', 'false');
      startFinalSequence();
    }

    function startFinalSequence() {
      if (!phoneFrameWrapper) return;
      if (currentConcept !== 3) {
        phoneFrameWrapper.style.transition = 'transform 6s ease-in-out';
        phoneFrameWrapper.classList.add('zoom-final');
      }
      setTimeout(function() {
        var toggle = document.getElementById('drawerBenefitsBreakdownToggle');
        var breakdown = document.getElementById('drawerBenefitsBreakdown');
        if (toggle && breakdown && breakdown.classList.contains('is-collapsed')) {
          toggle.click();
        }
      }, 1500);
      setTimeout(function() {
        var drawerBody = drawerPanel ? drawerPanel.querySelector('.drawer-body') : null;
        if (drawerBody) {
          drawerBody.scrollTo({ top: drawerBody.scrollHeight, behavior: 'smooth' });
        }
        setTimeout(function() {
          var confirmBtn = document.getElementById('drawerConfirmEstimateBtn');
          if (confirmBtn) {
            confirmBtn.classList.add('demo-tap');
            confirmBtn.click();
            setTimeout(function() {
              confirmBtn.classList.remove('demo-tap');
            }, 120);
          }
        }, 1200);
      }, 6000);
    }
    function showDrawerLoading() {
      if (drawerBodyCards) drawerBodyCards.classList.add('is-hidden');
      if (drawerPanel) drawerPanel.classList.add('is-loading');
      if (drawerLoadingProgress) drawerLoadingProgress.classList.remove('is-expanded');
      if (drawerLoading) {
        drawerLoading.classList.add('is-visible');
        drawerLoading.removeAttribute('hidden');
        if (drawerLoadingVideo) {
          var p = drawerLoadingVideo.play();
          if (p && p.catch) p.catch(function() {});
        }
      }
      setTimeout(function() {
        if (drawerLoadingProgress) drawerLoadingProgress.classList.add('is-expanded');
      }, 80);
      /* After loading plays briefly, reveal the first card (Figma result card) */
      setTimeout(showDrawerResultCard, 3500);
    }
    if (drawerApplyBtn) {
      drawerApplyBtn.addEventListener('click', function() {
        showDrawerLoading();
      });
    }
    if (drawerCancelBtn) {
      drawerCancelBtn.addEventListener('click', function() {
        closeDrawer();
      });
    }
    var drawerConfirmEstimateBtn = document.getElementById('drawerConfirmEstimateBtn');
    if (drawerConfirmEstimateBtn) {
      drawerConfirmEstimateBtn.addEventListener('click', function() {
        var summary = getEstimateSummaryFromDrawer();
        if (drawerOverlay) drawerOverlay.classList.add('drawer-showing-success');
        setTimeout(function() {
          if (drawerOverlay) drawerOverlay.classList.remove('drawer-showing-success');
          closeDrawer();
          var loadingMsg = createAssistantLoading();
          chatContainer.appendChild(loadingMsg);
          chatContainer.scrollTop = chatContainer.scrollHeight;
          setTimeout(function() {
            loadingMsg.remove();
            appendCongratsMessage(summary);
            setTimeout(runDemo, 6000);
          }, 1000);
        }, 1800);
      });
    }
    if (drawerBenefitsBreakdownToggle && drawerBenefitsBreakdown) {
      drawerBenefitsBreakdownToggle.addEventListener('click', function() {
        var isCollapsed = drawerBenefitsBreakdown.classList.toggle('is-collapsed');
        drawerBenefitsBreakdownToggle.setAttribute('aria-expanded', isCollapsed ? 'false' : 'true');
        drawerBenefitsBreakdownToggle.setAttribute('aria-label', isCollapsed ? 'Your benefits breakdown, collapsed. Click to expand.' : 'Your benefits breakdown, expanded. Click to collapse.');
      });
    }
    document.addEventListener('click', function(e) {
      if (e.target.closest('.btn-primary')) {
        e.preventDefault();
        openDrawer();
      }
      if (e.target === drawerOverlay) closeDrawer();
    });
    if (drawerClose) drawerClose.addEventListener('click', closeDrawer);
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && drawerOverlay && drawerOverlay.classList.contains('is-open')) closeDrawer();
      // D = toggle drawer (for testing – no animation, no clicking Personalize)
      if (e.key === 'd' && !e.ctrlKey && !e.metaKey && !e.altKey && e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
        e.preventDefault();
        if (drawerOverlay && drawerOverlay.classList.contains('is-open')) closeDrawer();
        else openDrawer();
      }
    });

    replayBtn.addEventListener('click', runDemo);
    if (skipBtn) skipBtn.addEventListener('click', skipDemo);

    var slideBackdrop = document.getElementById('slideBackdrop');
    var concept1Btn = document.getElementById('concept1Btn');
    var concept2Btn = document.getElementById('concept2Btn');
    var concept3Btn = document.getElementById('concept3Btn');
    if (concept1Btn && concept2Btn && concept3Btn) {
      function setConcept(num) {
        currentConcept = num;
        concept1Btn.classList.toggle('is-active', num === 1);
        concept2Btn.classList.toggle('is-active', num === 2);
        concept3Btn.classList.toggle('is-active', num === 3);
        if (slideBackdrop) {
          slideBackdrop.classList.toggle('concept-2', num === 2);
        }
        if (bgVideo) {
          if (num === 2) bgVideo.pause();
          else playBgVideo();
        }
        if (inputField) {
          inputField.placeholder = 'Ask anything...';
        }
        if (num === 1) concept2Cancelled = true;
        if ((num === 2 || num === 3) && drawerOverlay && drawerOverlay.classList.contains('is-open')) {
          closeDrawer();
        }
        runDemo();
      }
      concept1Btn.addEventListener('click', function() {
        if (currentConcept === 1) return;
        setConcept(1);
      });
      concept2Btn.addEventListener('click', function() {
        if (currentConcept === 2) return;
        setConcept(2);
      });
      concept3Btn.addEventListener('click', function() {
        if (currentConcept === 3) return;
        setConcept(3);
      });
    }

    // Dev/testing: open with #drawer to skip animation and show drawer immediately
    if (window.location.hash === '#drawer') {
      skipDemo();
      openDrawer();
    } else {
      runDemo();
    }
  </script>
</body>
</html>
